<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RadioTherapy: training Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">RadioTherapy
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('namespacetraining.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">training Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa3c7c69c4948ab69757e85881ec70de4" id="r_aa3c7c69c4948ab69757e85881ec70de4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa3c7c69c4948ab69757e85881ec70de4">select_channel</a> (image, <a class="el" href="#a6a19e36ca2973d062ada227b4334ea22">channel</a>=0)</td></tr>
<tr class="separator:aa3c7c69c4948ab69757e85881ec70de4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac397f585901f98e7641ec939e7100361" id="r_ac397f585901f98e7641ec939e7100361"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac397f585901f98e7641ec939e7100361">KL_loss</a> (<a class="el" href="#a2cd3eab0c728c5d13c4a9ffed35586e4">z_mu</a>, <a class="el" href="#ad7e870dcaeb35c2e00fd8b3e6e818473">z_sigma</a>)</td></tr>
<tr class="separator:ac397f585901f98e7641ec939e7100361"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ae95e1f39090a37341e13a6d57fc34d01" id="r_ae95e1f39090a37341e13a6d57fc34d01"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae95e1f39090a37341e13a6d57fc34d01">force</a></td></tr>
<tr class="separator:ae95e1f39090a37341e13a6d57fc34d01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af97251d7685066a2394b70872db1d9d6" id="r_af97251d7685066a2394b70872db1d9d6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af97251d7685066a2394b70872db1d9d6">directory</a> = os.environ.get(&quot;MONAI_DATA_DIRECTORY&quot;)</td></tr>
<tr class="separator:af97251d7685066a2394b70872db1d9d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9cf11684fa66b5f3c35868d34ac48ef" id="r_af9cf11684fa66b5f3c35868d34ac48ef"><td class="memItemLeft" align="right" valign="top">str&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af9cf11684fa66b5f3c35868d34ac48ef">root_dir</a> = &quot;/Users/giannigagliardi/Documents/Git/RadioTherapy/data&quot;</td></tr>
<tr class="separator:af9cf11684fa66b5f3c35868d34ac48ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b646060343fb55c2cd4bd93f7f8700b" id="r_a7b646060343fb55c2cd4bd93f7f8700b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7b646060343fb55c2cd4bd93f7f8700b">batch_size</a> = 1</td></tr>
<tr class="separator:a7b646060343fb55c2cd4bd93f7f8700b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a19e36ca2973d062ada227b4334ea22" id="r_a6a19e36ca2973d062ada227b4334ea22"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6a19e36ca2973d062ada227b4334ea22">channel</a> = 0</td></tr>
<tr class="separator:a6a19e36ca2973d062ada227b4334ea22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afff5309d80cb7064ae68a100d698c702" id="r_afff5309d80cb7064ae68a100d698c702"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afff5309d80cb7064ae68a100d698c702">train_transforms</a></td></tr>
<tr class="separator:afff5309d80cb7064ae68a100d698c702"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa811e971dc88624429d857151d09301" id="r_afa811e971dc88624429d857151d09301"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afa811e971dc88624429d857151d09301">train_ds</a></td></tr>
<tr class="separator:afa811e971dc88624429d857151d09301"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dad551e6b78b06c9b027213609b1f3e" id="r_a1dad551e6b78b06c9b027213609b1f3e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1dad551e6b78b06c9b027213609b1f3e">train_loader</a></td></tr>
<tr class="separator:a1dad551e6b78b06c9b027213609b1f3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2e72ed2e193555d2666612591286b46" id="r_ac2e72ed2e193555d2666612591286b46"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac2e72ed2e193555d2666612591286b46">device</a> = torch.device(&quot;cuda&quot; if torch.cuda.is_available() else &quot;cpu&quot;)</td></tr>
<tr class="separator:ac2e72ed2e193555d2666612591286b46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57ba5773263cb4f583c8e6652320b9dc" id="r_a57ba5773263cb4f583c8e6652320b9dc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a57ba5773263cb4f583c8e6652320b9dc">autoencoder</a></td></tr>
<tr class="separator:a57ba5773263cb4f583c8e6652320b9dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad944473fb2d682790c347a0def2e5190" id="r_ad944473fb2d682790c347a0def2e5190"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad944473fb2d682790c347a0def2e5190">discriminator</a></td></tr>
<tr class="separator:ad944473fb2d682790c347a0def2e5190"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6d0d00cfc64770ac28cb11210729a39" id="r_ad6d0d00cfc64770ac28cb11210729a39"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad6d0d00cfc64770ac28cb11210729a39">l1_loss</a> = L1Loss()</td></tr>
<tr class="separator:ad6d0d00cfc64770ac28cb11210729a39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ae302bf1d4c39293194d26fd06fe594" id="r_a1ae302bf1d4c39293194d26fd06fe594"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1ae302bf1d4c39293194d26fd06fe594">adv_loss</a> = PatchAdversarialLoss(criterion=&quot;least_squares&quot;)</td></tr>
<tr class="separator:a1ae302bf1d4c39293194d26fd06fe594"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a621cdbd3806638c3600ef205346d0b02" id="r_a621cdbd3806638c3600ef205346d0b02"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a621cdbd3806638c3600ef205346d0b02">loss_perceptual</a></td></tr>
<tr class="separator:a621cdbd3806638c3600ef205346d0b02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47dd5a0c213ce0c0d8f6250f980e3c5e" id="r_a47dd5a0c213ce0c0d8f6250f980e3c5e"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a47dd5a0c213ce0c0d8f6250f980e3c5e">adv_weight</a> = 0.01</td></tr>
<tr class="separator:a47dd5a0c213ce0c0d8f6250f980e3c5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae814e35d053417f2305925ab33aea345" id="r_ae814e35d053417f2305925ab33aea345"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae814e35d053417f2305925ab33aea345">perceptual_weight</a> = 0.001</td></tr>
<tr class="separator:ae814e35d053417f2305925ab33aea345"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17caef3eab656229514bcfb64643d91f" id="r_a17caef3eab656229514bcfb64643d91f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a17caef3eab656229514bcfb64643d91f">kl_weight</a> = 1e-6</td></tr>
<tr class="separator:a17caef3eab656229514bcfb64643d91f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a195e526bc225ca922bfd50418d43f573" id="r_a195e526bc225ca922bfd50418d43f573"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a195e526bc225ca922bfd50418d43f573">optimizer_g</a> = torch.optim.Adam(params=autoencoder.parameters(), lr=1e-4)</td></tr>
<tr class="separator:a195e526bc225ca922bfd50418d43f573"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6627d345a3207e87519fb26d3d45dffb" id="r_a6627d345a3207e87519fb26d3d45dffb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6627d345a3207e87519fb26d3d45dffb">optimizer_d</a> = torch.optim.Adam(params=discriminator.parameters(), lr=1e-4)</td></tr>
<tr class="separator:a6627d345a3207e87519fb26d3d45dffb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a195f6eb059ea5ded1c78baa7520e2fac" id="r_a195f6eb059ea5ded1c78baa7520e2fac"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a195f6eb059ea5ded1c78baa7520e2fac">n_epochs</a> = 10</td></tr>
<tr class="separator:a195f6eb059ea5ded1c78baa7520e2fac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2306f43853d7561a29187f93ea02672" id="r_ad2306f43853d7561a29187f93ea02672"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad2306f43853d7561a29187f93ea02672">autoencoder_warm_up_n_epochs</a> = 5</td></tr>
<tr class="separator:ad2306f43853d7561a29187f93ea02672"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb77d6c0f1c0bd1f6f57a537e724024d" id="r_acb77d6c0f1c0bd1f6f57a537e724024d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acb77d6c0f1c0bd1f6f57a537e724024d">val_interval</a> = 10</td></tr>
<tr class="separator:acb77d6c0f1c0bd1f6f57a537e724024d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af34848d9774d20aa4c3c64f227b88991" id="r_af34848d9774d20aa4c3c64f227b88991"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af34848d9774d20aa4c3c64f227b88991">epoch_recon_loss_list</a> = []</td></tr>
<tr class="separator:af34848d9774d20aa4c3c64f227b88991"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa979d8f4c3cbf310021c28561646afc9" id="r_aa979d8f4c3cbf310021c28561646afc9"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa979d8f4c3cbf310021c28561646afc9">epoch_gen_loss_list</a> = []</td></tr>
<tr class="separator:aa979d8f4c3cbf310021c28561646afc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71e114b005b9cc5b99eb8aab5df629e2" id="r_a71e114b005b9cc5b99eb8aab5df629e2"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a71e114b005b9cc5b99eb8aab5df629e2">epoch_disc_loss_list</a> = []</td></tr>
<tr class="separator:a71e114b005b9cc5b99eb8aab5df629e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4caf0bd6482657203cb209cf60cb9703" id="r_a4caf0bd6482657203cb209cf60cb9703"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4caf0bd6482657203cb209cf60cb9703">val_recon_epoch_loss_list</a> = []</td></tr>
<tr class="separator:a4caf0bd6482657203cb209cf60cb9703"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6d54e5e573572d57d495f8e3240ad97" id="r_ab6d54e5e573572d57d495f8e3240ad97"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab6d54e5e573572d57d495f8e3240ad97">intermediary_images</a> = []</td></tr>
<tr class="separator:ab6d54e5e573572d57d495f8e3240ad97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af99c62fd839f17beafc660f1fbbfa6dc" id="r_af99c62fd839f17beafc660f1fbbfa6dc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af99c62fd839f17beafc660f1fbbfa6dc">n_example_images</a> = 4</td></tr>
<tr class="separator:af99c62fd839f17beafc660f1fbbfa6dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4d64869dd3391087fde7e66e62bb93e" id="r_ad4d64869dd3391087fde7e66e62bb93e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad4d64869dd3391087fde7e66e62bb93e">epoch_loss</a> = 0</td></tr>
<tr class="separator:ad4d64869dd3391087fde7e66e62bb93e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a695789c9874ae81b39a2be9f2936ff9c" id="r_a695789c9874ae81b39a2be9f2936ff9c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a695789c9874ae81b39a2be9f2936ff9c">gen_epoch_loss</a> = 0</td></tr>
<tr class="separator:a695789c9874ae81b39a2be9f2936ff9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c169df83c2678cf4d07ab87861e9918" id="r_a9c169df83c2678cf4d07ab87861e9918"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9c169df83c2678cf4d07ab87861e9918">disc_epoch_loss</a> = 0</td></tr>
<tr class="separator:a9c169df83c2678cf4d07ab87861e9918"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fa3aecda63a9d35990fbf0c928c316f" id="r_a2fa3aecda63a9d35990fbf0c928c316f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2fa3aecda63a9d35990fbf0c928c316f">progress_bar</a> = tqdm(enumerate(<a class="el" href="#a1dad551e6b78b06c9b027213609b1f3e">train_loader</a>), total=len(<a class="el" href="#a1dad551e6b78b06c9b027213609b1f3e">train_loader</a>), <a class="el" href="#a87472fa42d8f8bfdc4e386a49f022040">ncols</a>=110)</td></tr>
<tr class="separator:a2fa3aecda63a9d35990fbf0c928c316f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60daebefe79b2f7162dfc801921765af" id="r_a60daebefe79b2f7162dfc801921765af"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a60daebefe79b2f7162dfc801921765af">images</a> = batch[&quot;image&quot;].to(<a class="el" href="#ac2e72ed2e193555d2666612591286b46">device</a>)</td></tr>
<tr class="separator:a60daebefe79b2f7162dfc801921765af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac61c15ad0e4f79cc2ebc49667748b0a6" id="r_ac61c15ad0e4f79cc2ebc49667748b0a6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac61c15ad0e4f79cc2ebc49667748b0a6">set_to_none</a></td></tr>
<tr class="separator:ac61c15ad0e4f79cc2ebc49667748b0a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c4da363a35e7bd34d22012d01919cf5" id="r_a8c4da363a35e7bd34d22012d01919cf5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8c4da363a35e7bd34d22012d01919cf5">reconstruction</a></td></tr>
<tr class="separator:a8c4da363a35e7bd34d22012d01919cf5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cd3eab0c728c5d13c4a9ffed35586e4" id="r_a2cd3eab0c728c5d13c4a9ffed35586e4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2cd3eab0c728c5d13c4a9ffed35586e4">z_mu</a></td></tr>
<tr class="separator:a2cd3eab0c728c5d13c4a9ffed35586e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7e870dcaeb35c2e00fd8b3e6e818473" id="r_ad7e870dcaeb35c2e00fd8b3e6e818473"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad7e870dcaeb35c2e00fd8b3e6e818473">z_sigma</a></td></tr>
<tr class="separator:ad7e870dcaeb35c2e00fd8b3e6e818473"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8f28182347fc97929b9a49efa5079af" id="r_ad8f28182347fc97929b9a49efa5079af"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad8f28182347fc97929b9a49efa5079af">kl_loss</a> = <a class="el" href="#ac397f585901f98e7641ec939e7100361">KL_loss</a>(<a class="el" href="#a2cd3eab0c728c5d13c4a9ffed35586e4">z_mu</a>, <a class="el" href="#ad7e870dcaeb35c2e00fd8b3e6e818473">z_sigma</a>)</td></tr>
<tr class="separator:ad8f28182347fc97929b9a49efa5079af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af627eea81e13276b45f3c0ae038f5a84" id="r_af627eea81e13276b45f3c0ae038f5a84"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af627eea81e13276b45f3c0ae038f5a84">recons_loss</a> = <a class="el" href="#ad6d0d00cfc64770ac28cb11210729a39">l1_loss</a>(reconstruction.float(), images.float())</td></tr>
<tr class="separator:af627eea81e13276b45f3c0ae038f5a84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a317496fb726f3606c1a9992b6f5e9899" id="r_a317496fb726f3606c1a9992b6f5e9899"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a317496fb726f3606c1a9992b6f5e9899">p_loss</a> = <a class="el" href="#a621cdbd3806638c3600ef205346d0b02">loss_perceptual</a>(reconstruction.float(), images.float())</td></tr>
<tr class="separator:a317496fb726f3606c1a9992b6f5e9899"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdc85e405efc71f7892a7ee6606e5e23" id="r_afdc85e405efc71f7892a7ee6606e5e23"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afdc85e405efc71f7892a7ee6606e5e23">loss_g</a> = <a class="el" href="#af627eea81e13276b45f3c0ae038f5a84">recons_loss</a> + <a class="el" href="#a17caef3eab656229514bcfb64643d91f">kl_weight</a> * <a class="el" href="#ad8f28182347fc97929b9a49efa5079af">kl_loss</a> + <a class="el" href="#ae814e35d053417f2305925ab33aea345">perceptual_weight</a> * <a class="el" href="#a317496fb726f3606c1a9992b6f5e9899">p_loss</a></td></tr>
<tr class="separator:afdc85e405efc71f7892a7ee6606e5e23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e2f8ec561388e69fc8bb37aa3a5930e" id="r_a1e2f8ec561388e69fc8bb37aa3a5930e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1e2f8ec561388e69fc8bb37aa3a5930e">logits_fake</a> = <a class="el" href="#ad944473fb2d682790c347a0def2e5190">discriminator</a>(reconstruction.contiguous().float())[-1]</td></tr>
<tr class="separator:a1e2f8ec561388e69fc8bb37aa3a5930e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d36ddfdaa62c930c002240d5c362b43" id="r_a5d36ddfdaa62c930c002240d5c362b43"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5d36ddfdaa62c930c002240d5c362b43">generator_loss</a></td></tr>
<tr class="separator:a5d36ddfdaa62c930c002240d5c362b43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e6b0846fc0dcbadfc338f2dcf8b1d02" id="r_a8e6b0846fc0dcbadfc338f2dcf8b1d02"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8e6b0846fc0dcbadfc338f2dcf8b1d02">loss_d_fake</a></td></tr>
<tr class="separator:a8e6b0846fc0dcbadfc338f2dcf8b1d02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a005332922e2a72cd36e0b33e60ad36d8" id="r_a005332922e2a72cd36e0b33e60ad36d8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a005332922e2a72cd36e0b33e60ad36d8">logits_real</a> = <a class="el" href="#ad944473fb2d682790c347a0def2e5190">discriminator</a>(images.contiguous().detach())[-1]</td></tr>
<tr class="separator:a005332922e2a72cd36e0b33e60ad36d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49f252553ce57d75a2fdd5a86a40d9c3" id="r_a49f252553ce57d75a2fdd5a86a40d9c3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a49f252553ce57d75a2fdd5a86a40d9c3">loss_d_real</a></td></tr>
<tr class="separator:a49f252553ce57d75a2fdd5a86a40d9c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae08c81334e30e5cba7ad5124f4033887" id="r_ae08c81334e30e5cba7ad5124f4033887"><td class="memItemLeft" align="right" valign="top">tuple&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae08c81334e30e5cba7ad5124f4033887">discriminator_loss</a> = (<a class="el" href="#a8e6b0846fc0dcbadfc338f2dcf8b1d02">loss_d_fake</a> + <a class="el" href="#a49f252553ce57d75a2fdd5a86a40d9c3">loss_d_real</a>) * 0.5</td></tr>
<tr class="separator:ae08c81334e30e5cba7ad5124f4033887"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac77f55de4cd1cb14a9ba7acb8dc27542" id="r_ac77f55de4cd1cb14a9ba7acb8dc27542"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac77f55de4cd1cb14a9ba7acb8dc27542">loss_d</a> = <a class="el" href="#a47dd5a0c213ce0c0d8f6250f980e3c5e">adv_weight</a> * <a class="el" href="#ae08c81334e30e5cba7ad5124f4033887">discriminator_loss</a></td></tr>
<tr class="separator:ac77f55de4cd1cb14a9ba7acb8dc27542"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4658ac1f5dd4fd3f065a2787b1f5e2d" id="r_ae4658ac1f5dd4fd3f065a2787b1f5e2d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae4658ac1f5dd4fd3f065a2787b1f5e2d">fontsize</a></td></tr>
<tr class="separator:ae4658ac1f5dd4fd3f065a2787b1f5e2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a94c23759bc33b642eee674783bddbd" id="r_a0a94c23759bc33b642eee674783bddbd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0a94c23759bc33b642eee674783bddbd">prop</a></td></tr>
<tr class="separator:a0a94c23759bc33b642eee674783bddbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6e5a935cde52b48bfcf15329b663fe3" id="r_ae6e5a935cde52b48bfcf15329b663fe3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae6e5a935cde52b48bfcf15329b663fe3">color</a></td></tr>
<tr class="separator:ae6e5a935cde52b48bfcf15329b663fe3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace3d8455fb4a76f9c7306d95df7ffa3f" id="r_ace3d8455fb4a76f9c7306d95df7ffa3f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ace3d8455fb4a76f9c7306d95df7ffa3f">linewidth</a></td></tr>
<tr class="separator:ace3d8455fb4a76f9c7306d95df7ffa3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40c8eeb21937c513c86ae10fb8b51c93" id="r_a40c8eeb21937c513c86ae10fb8b51c93"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a40c8eeb21937c513c86ae10fb8b51c93">label</a></td></tr>
<tr class="separator:a40c8eeb21937c513c86ae10fb8b51c93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62902f5e805af286ffcd7961376a3ebc" id="r_a62902f5e805af286ffcd7961376a3ebc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a62902f5e805af286ffcd7961376a3ebc">idx</a> = 0</td></tr>
<tr class="separator:a62902f5e805af286ffcd7961376a3ebc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab876b11f161f3ff5f96fa740468ea87a" id="r_ab876b11f161f3ff5f96fa740468ea87a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab876b11f161f3ff5f96fa740468ea87a">img</a> = <a class="el" href="#a8c4da363a35e7bd34d22012d01919cf5">reconstruction</a>[<a class="el" href="#a62902f5e805af286ffcd7961376a3ebc">idx</a>, <a class="el" href="#a6a19e36ca2973d062ada227b4334ea22">channel</a>].detach().cpu().numpy()</td></tr>
<tr class="separator:ab876b11f161f3ff5f96fa740468ea87a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f3e242cbdfda52c0f71420c44961dbb" id="r_a7f3e242cbdfda52c0f71420c44961dbb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7f3e242cbdfda52c0f71420c44961dbb">fig</a></td></tr>
<tr class="separator:a7f3e242cbdfda52c0f71420c44961dbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6126b3c2c2c8613f18efd0ceba489642" id="r_a6126b3c2c2c8613f18efd0ceba489642"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6126b3c2c2c8613f18efd0ceba489642">axs</a></td></tr>
<tr class="separator:a6126b3c2c2c8613f18efd0ceba489642"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42059bc1be8500c5849414a4e9220172" id="r_a42059bc1be8500c5849414a4e9220172"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a42059bc1be8500c5849414a4e9220172">nrows</a></td></tr>
<tr class="separator:a42059bc1be8500c5849414a4e9220172"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87472fa42d8f8bfdc4e386a49f022040" id="r_a87472fa42d8f8bfdc4e386a49f022040"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a87472fa42d8f8bfdc4e386a49f022040">ncols</a></td></tr>
<tr class="separator:a87472fa42d8f8bfdc4e386a49f022040"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb3a1ed3e438addfba34cb8b9207d11f" id="r_acb3a1ed3e438addfba34cb8b9207d11f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acb3a1ed3e438addfba34cb8b9207d11f">ax</a> = <a class="el" href="#a6126b3c2c2c8613f18efd0ceba489642">axs</a>[0]</td></tr>
<tr class="separator:acb3a1ed3e438addfba34cb8b9207d11f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a957ac07698baa6c7ecc554c082fb781b" id="r_a957ac07698baa6c7ecc554c082fb781b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a957ac07698baa6c7ecc554c082fb781b">cmap</a></td></tr>
<tr class="separator:a957ac07698baa6c7ecc554c082fb781b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a8b9b4825d205a673e21352b91cf716" id="r_a5a8b9b4825d205a673e21352b91cf716"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5a8b9b4825d205a673e21352b91cf716">unet</a></td></tr>
<tr class="separator:a5a8b9b4825d205a673e21352b91cf716"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fa3b45221836282657747b1c5c0bfd1" id="r_a9fa3b45221836282657747b1c5c0bfd1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9fa3b45221836282657747b1c5c0bfd1">scheduler</a></td></tr>
<tr class="separator:a9fa3b45221836282657747b1c5c0bfd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9652d83fbe87882dff58283216545de" id="r_ae9652d83fbe87882dff58283216545de"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae9652d83fbe87882dff58283216545de">enabled</a></td></tr>
<tr class="separator:ae9652d83fbe87882dff58283216545de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff151287638b4debf8d1d3ca23e3e151" id="r_aff151287638b4debf8d1d3ca23e3e151"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aff151287638b4debf8d1d3ca23e3e151">first_batch</a> = first(<a class="el" href="#a1dad551e6b78b06c9b027213609b1f3e">train_loader</a>)</td></tr>
<tr class="separator:aff151287638b4debf8d1d3ca23e3e151"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3b20336dd35c41b00e8433dafe88c08" id="r_aa3b20336dd35c41b00e8433dafe88c08"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa3b20336dd35c41b00e8433dafe88c08">z</a> = autoencoder.encode_stage_2_inputs(<a class="el" href="#aff151287638b4debf8d1d3ca23e3e151">first_batch</a>[&quot;image&quot;].to(<a class="el" href="#ac2e72ed2e193555d2666612591286b46">device</a>))</td></tr>
<tr class="separator:aa3b20336dd35c41b00e8433dafe88c08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92e8c1918f5006039bf08ad89f6a5b6d" id="r_a92e8c1918f5006039bf08ad89f6a5b6d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a92e8c1918f5006039bf08ad89f6a5b6d">scale_factor</a> = 1 / torch.std(<a class="el" href="#aa3b20336dd35c41b00e8433dafe88c08">z</a>)</td></tr>
<tr class="separator:a92e8c1918f5006039bf08ad89f6a5b6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a137beeade654d0c6abe37f9a9ed039ce" id="r_a137beeade654d0c6abe37f9a9ed039ce"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a137beeade654d0c6abe37f9a9ed039ce">inferer</a> = LatentDiffusionInferer(<a class="el" href="#a9fa3b45221836282657747b1c5c0bfd1">scheduler</a>, <a class="el" href="#a92e8c1918f5006039bf08ad89f6a5b6d">scale_factor</a>=<a class="el" href="#a92e8c1918f5006039bf08ad89f6a5b6d">scale_factor</a>)</td></tr>
<tr class="separator:a137beeade654d0c6abe37f9a9ed039ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab00c6ded1dbcdd39e6c8b99cdeb4212" id="r_aab00c6ded1dbcdd39e6c8b99cdeb4212"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aab00c6ded1dbcdd39e6c8b99cdeb4212">optimizer_diff</a> = torch.optim.Adam(params=unet.parameters(), lr=1e-4)</td></tr>
<tr class="separator:aab00c6ded1dbcdd39e6c8b99cdeb4212"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb676488240e36e121315308c9101522" id="r_abb676488240e36e121315308c9101522"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abb676488240e36e121315308c9101522">epoch_loss_list</a> = []</td></tr>
<tr class="separator:abb676488240e36e121315308c9101522"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae31c0032dea952c82ed488c0c0200c7f" id="r_ae31c0032dea952c82ed488c0c0200c7f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae31c0032dea952c82ed488c0c0200c7f">scaler</a> = GradScaler()</td></tr>
<tr class="separator:ae31c0032dea952c82ed488c0c0200c7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf5b70a3b8ad89e4cacbb60030d5b6a4" id="r_acf5b70a3b8ad89e4cacbb60030d5b6a4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acf5b70a3b8ad89e4cacbb60030d5b6a4">device_type</a></td></tr>
<tr class="separator:acf5b70a3b8ad89e4cacbb60030d5b6a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae85fdada3b87e7e73b7d1a7ca20680a0" id="r_ae85fdada3b87e7e73b7d1a7ca20680a0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae85fdada3b87e7e73b7d1a7ca20680a0">noise</a> = torch.randn_like(<a class="el" href="#aa3b20336dd35c41b00e8433dafe88c08">z</a>).to(<a class="el" href="#ac2e72ed2e193555d2666612591286b46">device</a>)</td></tr>
<tr class="separator:ae85fdada3b87e7e73b7d1a7ca20680a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f54d343a09f11ab6b7830e33f2b7cc0" id="r_a9f54d343a09f11ab6b7830e33f2b7cc0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9f54d343a09f11ab6b7830e33f2b7cc0">timesteps</a></td></tr>
<tr class="separator:a9f54d343a09f11ab6b7830e33f2b7cc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee05a4a026bfd6da60b6a754b13b4d9e" id="r_aee05a4a026bfd6da60b6a754b13b4d9e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aee05a4a026bfd6da60b6a754b13b4d9e">noise_pred</a></td></tr>
<tr class="separator:aee05a4a026bfd6da60b6a754b13b4d9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4384320b3de144a884cd975abb4a3a06" id="r_a4384320b3de144a884cd975abb4a3a06"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4384320b3de144a884cd975abb4a3a06">loss</a> = F.mse_loss(noise_pred.float(), noise.float())</td></tr>
<tr class="separator:a4384320b3de144a884cd975abb4a3a06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66e1f3060beddf3de574b43f8023a346" id="r_a66e1f3060beddf3de574b43f8023a346"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a66e1f3060beddf3de574b43f8023a346">num_inference_steps</a></td></tr>
<tr class="separator:a66e1f3060beddf3de574b43f8023a346"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a53cfb53649304f990778b717ceb1ab" id="r_a8a53cfb53649304f990778b717ceb1ab"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8a53cfb53649304f990778b717ceb1ab">synthetic_images</a></td></tr>
<tr class="separator:a8a53cfb53649304f990778b717ceb1ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="ac397f585901f98e7641ec939e7100361" name="ac397f585901f98e7641ec939e7100361"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac397f585901f98e7641ec939e7100361">&#9670;&#160;</a></span>KL_loss()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.KL_loss </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>z_mu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>z_sigma</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aa3c7c69c4948ab69757e85881ec70de4" name="aa3c7c69c4948ab69757e85881ec70de4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3c7c69c4948ab69757e85881ec70de4">&#9670;&#160;</a></span>select_channel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.select_channel </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>image</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>channel</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a1ae302bf1d4c39293194d26fd06fe594" name="a1ae302bf1d4c39293194d26fd06fe594"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ae302bf1d4c39293194d26fd06fe594">&#9670;&#160;</a></span>adv_loss</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.adv_loss = PatchAdversarialLoss(criterion=&quot;least_squares&quot;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a47dd5a0c213ce0c0d8f6250f980e3c5e" name="a47dd5a0c213ce0c0d8f6250f980e3c5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47dd5a0c213ce0c0d8f6250f980e3c5e">&#9670;&#160;</a></span>adv_weight</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float training.adv_weight = 0.01</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a57ba5773263cb4f583c8e6652320b9dc" name="a57ba5773263cb4f583c8e6652320b9dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57ba5773263cb4f583c8e6652320b9dc">&#9670;&#160;</a></span>autoencoder</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.autoencoder</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  AutoencoderKL(</div>
<div class="line"><span class="lineno">    2</span>        spatial_dims=3,</div>
<div class="line"><span class="lineno">    3</span>        in_channels=1,</div>
<div class="line"><span class="lineno">    4</span>        out_channels=1,</div>
<div class="line"><span class="lineno">    5</span>        num_channels=(32, 32, 32),</div>
<div class="line"><span class="lineno">    6</span>        latent_channels=2,</div>
<div class="line"><span class="lineno">    7</span>        num_res_blocks=1,</div>
<div class="line"><span class="lineno">    8</span>        norm_num_groups=8,</div>
<div class="line"><span class="lineno">    9</span>        attention_levels=(<span class="keyword">False</span>, <span class="keyword">False</span>, <span class="keyword">True</span>),</div>
<div class="line"><span class="lineno">   10</span>    )</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad2306f43853d7561a29187f93ea02672" name="ad2306f43853d7561a29187f93ea02672"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2306f43853d7561a29187f93ea02672">&#9670;&#160;</a></span>autoencoder_warm_up_n_epochs</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int training.autoencoder_warm_up_n_epochs = 5</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="acb3a1ed3e438addfba34cb8b9207d11f" name="acb3a1ed3e438addfba34cb8b9207d11f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb3a1ed3e438addfba34cb8b9207d11f">&#9670;&#160;</a></span>ax</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.ax = <a class="el" href="#a6126b3c2c2c8613f18efd0ceba489642">axs</a>[0]</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6126b3c2c2c8613f18efd0ceba489642" name="a6126b3c2c2c8613f18efd0ceba489642"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6126b3c2c2c8613f18efd0ceba489642">&#9670;&#160;</a></span>axs</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.axs</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a7b646060343fb55c2cd4bd93f7f8700b" name="a7b646060343fb55c2cd4bd93f7f8700b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b646060343fb55c2cd4bd93f7f8700b">&#9670;&#160;</a></span>batch_size</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int training.batch_size = 1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6a19e36ca2973d062ada227b4334ea22" name="a6a19e36ca2973d062ada227b4334ea22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a19e36ca2973d062ada227b4334ea22">&#9670;&#160;</a></span>channel</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int training.channel = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a957ac07698baa6c7ecc554c082fb781b" name="a957ac07698baa6c7ecc554c082fb781b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a957ac07698baa6c7ecc554c082fb781b">&#9670;&#160;</a></span>cmap</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.cmap</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae6e5a935cde52b48bfcf15329b663fe3" name="ae6e5a935cde52b48bfcf15329b663fe3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6e5a935cde52b48bfcf15329b663fe3">&#9670;&#160;</a></span>color</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.color</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac2e72ed2e193555d2666612591286b46" name="ac2e72ed2e193555d2666612591286b46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2e72ed2e193555d2666612591286b46">&#9670;&#160;</a></span>device</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.device = torch.device(&quot;cuda&quot; if torch.cuda.is_available() else &quot;cpu&quot;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="acf5b70a3b8ad89e4cacbb60030d5b6a4" name="acf5b70a3b8ad89e4cacbb60030d5b6a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf5b70a3b8ad89e4cacbb60030d5b6a4">&#9670;&#160;</a></span>device_type</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.device_type</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af97251d7685066a2394b70872db1d9d6" name="af97251d7685066a2394b70872db1d9d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af97251d7685066a2394b70872db1d9d6">&#9670;&#160;</a></span>directory</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.directory = os.environ.get(&quot;MONAI_DATA_DIRECTORY&quot;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a9c169df83c2678cf4d07ab87861e9918" name="a9c169df83c2678cf4d07ab87861e9918"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c169df83c2678cf4d07ab87861e9918">&#9670;&#160;</a></span>disc_epoch_loss</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int training.disc_epoch_loss = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad944473fb2d682790c347a0def2e5190" name="ad944473fb2d682790c347a0def2e5190"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad944473fb2d682790c347a0def2e5190">&#9670;&#160;</a></span>discriminator</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.discriminator</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  PatchDiscriminator(</div>
<div class="line"><span class="lineno">    2</span>        spatial_dims=3, num_layers_d=3, num_channels=32, in_channels=1, out_channels=1</div>
<div class="line"><span class="lineno">    3</span>    )</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae08c81334e30e5cba7ad5124f4033887" name="ae08c81334e30e5cba7ad5124f4033887"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae08c81334e30e5cba7ad5124f4033887">&#9670;&#160;</a></span>discriminator_loss</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">tuple training.discriminator_loss = (<a class="el" href="#a8e6b0846fc0dcbadfc338f2dcf8b1d02">loss_d_fake</a> + <a class="el" href="#a49f252553ce57d75a2fdd5a86a40d9c3">loss_d_real</a>) * 0.5</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae9652d83fbe87882dff58283216545de" name="ae9652d83fbe87882dff58283216545de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9652d83fbe87882dff58283216545de">&#9670;&#160;</a></span>enabled</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.enabled</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a71e114b005b9cc5b99eb8aab5df629e2" name="a71e114b005b9cc5b99eb8aab5df629e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71e114b005b9cc5b99eb8aab5df629e2">&#9670;&#160;</a></span>epoch_disc_loss_list</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.epoch_disc_loss_list = []</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aa979d8f4c3cbf310021c28561646afc9" name="aa979d8f4c3cbf310021c28561646afc9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa979d8f4c3cbf310021c28561646afc9">&#9670;&#160;</a></span>epoch_gen_loss_list</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.epoch_gen_loss_list = []</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad4d64869dd3391087fde7e66e62bb93e" name="ad4d64869dd3391087fde7e66e62bb93e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4d64869dd3391087fde7e66e62bb93e">&#9670;&#160;</a></span>epoch_loss</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int training.epoch_loss = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="abb676488240e36e121315308c9101522" name="abb676488240e36e121315308c9101522"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb676488240e36e121315308c9101522">&#9670;&#160;</a></span>epoch_loss_list</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.epoch_loss_list = []</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af34848d9774d20aa4c3c64f227b88991" name="af34848d9774d20aa4c3c64f227b88991"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af34848d9774d20aa4c3c64f227b88991">&#9670;&#160;</a></span>epoch_recon_loss_list</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">list training.epoch_recon_loss_list = []</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a7f3e242cbdfda52c0f71420c44961dbb" name="a7f3e242cbdfda52c0f71420c44961dbb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f3e242cbdfda52c0f71420c44961dbb">&#9670;&#160;</a></span>fig</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.fig</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aff151287638b4debf8d1d3ca23e3e151" name="aff151287638b4debf8d1d3ca23e3e151"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff151287638b4debf8d1d3ca23e3e151">&#9670;&#160;</a></span>first_batch</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.first_batch = first(<a class="el" href="#a1dad551e6b78b06c9b027213609b1f3e">train_loader</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae4658ac1f5dd4fd3f065a2787b1f5e2d" name="ae4658ac1f5dd4fd3f065a2787b1f5e2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4658ac1f5dd4fd3f065a2787b1f5e2d">&#9670;&#160;</a></span>fontsize</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.fontsize</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae95e1f39090a37341e13a6d57fc34d01" name="ae95e1f39090a37341e13a6d57fc34d01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae95e1f39090a37341e13a6d57fc34d01">&#9670;&#160;</a></span>force</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.force</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a695789c9874ae81b39a2be9f2936ff9c" name="a695789c9874ae81b39a2be9f2936ff9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a695789c9874ae81b39a2be9f2936ff9c">&#9670;&#160;</a></span>gen_epoch_loss</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int training.gen_epoch_loss = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a5d36ddfdaa62c930c002240d5c362b43" name="a5d36ddfdaa62c930c002240d5c362b43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d36ddfdaa62c930c002240d5c362b43">&#9670;&#160;</a></span>generator_loss</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.generator_loss</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  adv_loss(</div>
<div class="line"><span class="lineno">    2</span>                    logits_fake, target_is_real=<span class="keyword">True</span>, for_discriminator=<span class="keyword">False</span></div>
<div class="line"><span class="lineno">    3</span>                )</div>
</div><!-- fragment -->
</div>
</div>
<a id="a62902f5e805af286ffcd7961376a3ebc" name="a62902f5e805af286ffcd7961376a3ebc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62902f5e805af286ffcd7961376a3ebc">&#9670;&#160;</a></span>idx</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int training.idx = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a60daebefe79b2f7162dfc801921765af" name="a60daebefe79b2f7162dfc801921765af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60daebefe79b2f7162dfc801921765af">&#9670;&#160;</a></span>images</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.images = batch[&quot;image&quot;].to(<a class="el" href="#ac2e72ed2e193555d2666612591286b46">device</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab876b11f161f3ff5f96fa740468ea87a" name="ab876b11f161f3ff5f96fa740468ea87a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab876b11f161f3ff5f96fa740468ea87a">&#9670;&#160;</a></span>img</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.img = <a class="el" href="#a8c4da363a35e7bd34d22012d01919cf5">reconstruction</a>[<a class="el" href="#a62902f5e805af286ffcd7961376a3ebc">idx</a>, <a class="el" href="#a6a19e36ca2973d062ada227b4334ea22">channel</a>].detach().cpu().numpy()</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a137beeade654d0c6abe37f9a9ed039ce" name="a137beeade654d0c6abe37f9a9ed039ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a137beeade654d0c6abe37f9a9ed039ce">&#9670;&#160;</a></span>inferer</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.inferer = LatentDiffusionInferer(<a class="el" href="#a9fa3b45221836282657747b1c5c0bfd1">scheduler</a>, <a class="el" href="#a92e8c1918f5006039bf08ad89f6a5b6d">scale_factor</a>=<a class="el" href="#a92e8c1918f5006039bf08ad89f6a5b6d">scale_factor</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab6d54e5e573572d57d495f8e3240ad97" name="ab6d54e5e573572d57d495f8e3240ad97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6d54e5e573572d57d495f8e3240ad97">&#9670;&#160;</a></span>intermediary_images</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">list training.intermediary_images = []</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad8f28182347fc97929b9a49efa5079af" name="ad8f28182347fc97929b9a49efa5079af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8f28182347fc97929b9a49efa5079af">&#9670;&#160;</a></span>kl_loss</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.kl_loss = <a class="el" href="#ac397f585901f98e7641ec939e7100361">KL_loss</a>(<a class="el" href="#a2cd3eab0c728c5d13c4a9ffed35586e4">z_mu</a>, <a class="el" href="#ad7e870dcaeb35c2e00fd8b3e6e818473">z_sigma</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a17caef3eab656229514bcfb64643d91f" name="a17caef3eab656229514bcfb64643d91f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17caef3eab656229514bcfb64643d91f">&#9670;&#160;</a></span>kl_weight</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int training.kl_weight = 1e-6</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad6d0d00cfc64770ac28cb11210729a39" name="ad6d0d00cfc64770ac28cb11210729a39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6d0d00cfc64770ac28cb11210729a39">&#9670;&#160;</a></span>l1_loss</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.l1_loss = L1Loss()</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a40c8eeb21937c513c86ae10fb8b51c93" name="a40c8eeb21937c513c86ae10fb8b51c93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40c8eeb21937c513c86ae10fb8b51c93">&#9670;&#160;</a></span>label</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.label</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ace3d8455fb4a76f9c7306d95df7ffa3f" name="ace3d8455fb4a76f9c7306d95df7ffa3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace3d8455fb4a76f9c7306d95df7ffa3f">&#9670;&#160;</a></span>linewidth</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.linewidth</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a1e2f8ec561388e69fc8bb37aa3a5930e" name="a1e2f8ec561388e69fc8bb37aa3a5930e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e2f8ec561388e69fc8bb37aa3a5930e">&#9670;&#160;</a></span>logits_fake</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.logits_fake = <a class="el" href="#ad944473fb2d682790c347a0def2e5190">discriminator</a>(reconstruction.contiguous().float())[-1]</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a005332922e2a72cd36e0b33e60ad36d8" name="a005332922e2a72cd36e0b33e60ad36d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a005332922e2a72cd36e0b33e60ad36d8">&#9670;&#160;</a></span>logits_real</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.logits_real = <a class="el" href="#ad944473fb2d682790c347a0def2e5190">discriminator</a>(images.contiguous().detach())[-1]</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a4384320b3de144a884cd975abb4a3a06" name="a4384320b3de144a884cd975abb4a3a06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4384320b3de144a884cd975abb4a3a06">&#9670;&#160;</a></span>loss</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.loss = F.mse_loss(noise_pred.float(), noise.float())</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac77f55de4cd1cb14a9ba7acb8dc27542" name="ac77f55de4cd1cb14a9ba7acb8dc27542"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac77f55de4cd1cb14a9ba7acb8dc27542">&#9670;&#160;</a></span>loss_d</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float training.loss_d = <a class="el" href="#a47dd5a0c213ce0c0d8f6250f980e3c5e">adv_weight</a> * <a class="el" href="#ae08c81334e30e5cba7ad5124f4033887">discriminator_loss</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8e6b0846fc0dcbadfc338f2dcf8b1d02" name="a8e6b0846fc0dcbadfc338f2dcf8b1d02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e6b0846fc0dcbadfc338f2dcf8b1d02">&#9670;&#160;</a></span>loss_d_fake</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.loss_d_fake</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  adv_loss(</div>
<div class="line"><span class="lineno">    2</span>                    logits_fake, target_is_real=<span class="keyword">False</span>, for_discriminator=<span class="keyword">True</span></div>
<div class="line"><span class="lineno">    3</span>                )</div>
</div><!-- fragment -->
</div>
</div>
<a id="a49f252553ce57d75a2fdd5a86a40d9c3" name="a49f252553ce57d75a2fdd5a86a40d9c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49f252553ce57d75a2fdd5a86a40d9c3">&#9670;&#160;</a></span>loss_d_real</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.loss_d_real</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  adv_loss(</div>
<div class="line"><span class="lineno">    2</span>                    logits_real, target_is_real=<span class="keyword">True</span>, for_discriminator=<span class="keyword">True</span></div>
<div class="line"><span class="lineno">    3</span>                )</div>
</div><!-- fragment -->
</div>
</div>
<a id="afdc85e405efc71f7892a7ee6606e5e23" name="afdc85e405efc71f7892a7ee6606e5e23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afdc85e405efc71f7892a7ee6606e5e23">&#9670;&#160;</a></span>loss_g</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int training.loss_g = <a class="el" href="#af627eea81e13276b45f3c0ae038f5a84">recons_loss</a> + <a class="el" href="#a17caef3eab656229514bcfb64643d91f">kl_weight</a> * <a class="el" href="#ad8f28182347fc97929b9a49efa5079af">kl_loss</a> + <a class="el" href="#ae814e35d053417f2305925ab33aea345">perceptual_weight</a> * <a class="el" href="#a317496fb726f3606c1a9992b6f5e9899">p_loss</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a621cdbd3806638c3600ef205346d0b02" name="a621cdbd3806638c3600ef205346d0b02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a621cdbd3806638c3600ef205346d0b02">&#9670;&#160;</a></span>loss_perceptual</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.loss_perceptual</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  PerceptualLoss(</div>
<div class="line"><span class="lineno">    2</span>        spatial_dims=3, network_type=<span class="stringliteral">&quot;squeeze&quot;</span>, is_fake_3d=<span class="keyword">True</span>, fake_3d_ratio=0.2</div>
<div class="line"><span class="lineno">    3</span>    )</div>
</div><!-- fragment -->
</div>
</div>
<a id="a195f6eb059ea5ded1c78baa7520e2fac" name="a195f6eb059ea5ded1c78baa7520e2fac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a195f6eb059ea5ded1c78baa7520e2fac">&#9670;&#160;</a></span>n_epochs</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int training.n_epochs = 10</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af99c62fd839f17beafc660f1fbbfa6dc" name="af99c62fd839f17beafc660f1fbbfa6dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af99c62fd839f17beafc660f1fbbfa6dc">&#9670;&#160;</a></span>n_example_images</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int training.n_example_images = 4</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a87472fa42d8f8bfdc4e386a49f022040" name="a87472fa42d8f8bfdc4e386a49f022040"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87472fa42d8f8bfdc4e386a49f022040">&#9670;&#160;</a></span>ncols</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.ncols</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae85fdada3b87e7e73b7d1a7ca20680a0" name="ae85fdada3b87e7e73b7d1a7ca20680a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae85fdada3b87e7e73b7d1a7ca20680a0">&#9670;&#160;</a></span>noise</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.noise = torch.randn_like(<a class="el" href="#aa3b20336dd35c41b00e8433dafe88c08">z</a>).to(<a class="el" href="#ac2e72ed2e193555d2666612591286b46">device</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aee05a4a026bfd6da60b6a754b13b4d9e" name="aee05a4a026bfd6da60b6a754b13b4d9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee05a4a026bfd6da60b6a754b13b4d9e">&#9670;&#160;</a></span>noise_pred</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.noise_pred</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  inferer(</div>
<div class="line"><span class="lineno">    2</span>                    inputs=images,</div>
<div class="line"><span class="lineno">    3</span>                    autoencoder_model=autoencoder,</div>
<div class="line"><span class="lineno">    4</span>                    diffusion_model=unet,</div>
<div class="line"><span class="lineno">    5</span>                    noise=noise,</div>
<div class="line"><span class="lineno">    6</span>                    timesteps=timesteps,</div>
<div class="line"><span class="lineno">    7</span>                )</div>
</div><!-- fragment -->
</div>
</div>
<a id="a42059bc1be8500c5849414a4e9220172" name="a42059bc1be8500c5849414a4e9220172"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42059bc1be8500c5849414a4e9220172">&#9670;&#160;</a></span>nrows</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.nrows</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a66e1f3060beddf3de574b43f8023a346" name="a66e1f3060beddf3de574b43f8023a346"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66e1f3060beddf3de574b43f8023a346">&#9670;&#160;</a></span>num_inference_steps</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.num_inference_steps</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6627d345a3207e87519fb26d3d45dffb" name="a6627d345a3207e87519fb26d3d45dffb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6627d345a3207e87519fb26d3d45dffb">&#9670;&#160;</a></span>optimizer_d</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.optimizer_d = torch.optim.Adam(params=discriminator.parameters(), lr=1e-4)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aab00c6ded1dbcdd39e6c8b99cdeb4212" name="aab00c6ded1dbcdd39e6c8b99cdeb4212"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab00c6ded1dbcdd39e6c8b99cdeb4212">&#9670;&#160;</a></span>optimizer_diff</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.optimizer_diff = torch.optim.Adam(params=unet.parameters(), lr=1e-4)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a195e526bc225ca922bfd50418d43f573" name="a195e526bc225ca922bfd50418d43f573"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a195e526bc225ca922bfd50418d43f573">&#9670;&#160;</a></span>optimizer_g</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.optimizer_g = torch.optim.Adam(params=autoencoder.parameters(), lr=1e-4)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a317496fb726f3606c1a9992b6f5e9899" name="a317496fb726f3606c1a9992b6f5e9899"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a317496fb726f3606c1a9992b6f5e9899">&#9670;&#160;</a></span>p_loss</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.p_loss = <a class="el" href="#a621cdbd3806638c3600ef205346d0b02">loss_perceptual</a>(reconstruction.float(), images.float())</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae814e35d053417f2305925ab33aea345" name="ae814e35d053417f2305925ab33aea345"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae814e35d053417f2305925ab33aea345">&#9670;&#160;</a></span>perceptual_weight</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float training.perceptual_weight = 0.001</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2fa3aecda63a9d35990fbf0c928c316f" name="a2fa3aecda63a9d35990fbf0c928c316f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2fa3aecda63a9d35990fbf0c928c316f">&#9670;&#160;</a></span>progress_bar</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.progress_bar = tqdm(enumerate(<a class="el" href="#a1dad551e6b78b06c9b027213609b1f3e">train_loader</a>), total=len(<a class="el" href="#a1dad551e6b78b06c9b027213609b1f3e">train_loader</a>), <a class="el" href="#a87472fa42d8f8bfdc4e386a49f022040">ncols</a>=110)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a0a94c23759bc33b642eee674783bddbd" name="a0a94c23759bc33b642eee674783bddbd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a94c23759bc33b642eee674783bddbd">&#9670;&#160;</a></span>prop</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.prop</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af627eea81e13276b45f3c0ae038f5a84" name="af627eea81e13276b45f3c0ae038f5a84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af627eea81e13276b45f3c0ae038f5a84">&#9670;&#160;</a></span>recons_loss</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.recons_loss = <a class="el" href="#ad6d0d00cfc64770ac28cb11210729a39">l1_loss</a>(reconstruction.float(), images.float())</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8c4da363a35e7bd34d22012d01919cf5" name="a8c4da363a35e7bd34d22012d01919cf5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c4da363a35e7bd34d22012d01919cf5">&#9670;&#160;</a></span>reconstruction</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.reconstruction</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af9cf11684fa66b5f3c35868d34ac48ef" name="af9cf11684fa66b5f3c35868d34ac48ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9cf11684fa66b5f3c35868d34ac48ef">&#9670;&#160;</a></span>root_dir</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">str training.root_dir = &quot;/Users/giannigagliardi/Documents/Git/RadioTherapy/data&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a92e8c1918f5006039bf08ad89f6a5b6d" name="a92e8c1918f5006039bf08ad89f6a5b6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92e8c1918f5006039bf08ad89f6a5b6d">&#9670;&#160;</a></span>scale_factor</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int training.scale_factor = 1 / torch.std(<a class="el" href="#aa3b20336dd35c41b00e8433dafe88c08">z</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae31c0032dea952c82ed488c0c0200c7f" name="ae31c0032dea952c82ed488c0c0200c7f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae31c0032dea952c82ed488c0c0200c7f">&#9670;&#160;</a></span>scaler</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.scaler = GradScaler()</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a9fa3b45221836282657747b1c5c0bfd1" name="a9fa3b45221836282657747b1c5c0bfd1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fa3b45221836282657747b1c5c0bfd1">&#9670;&#160;</a></span>scheduler</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.scheduler</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  DDPMScheduler(</div>
<div class="line"><span class="lineno">    2</span>        num_train_timesteps=1000,</div>
<div class="line"><span class="lineno">    3</span>        schedule=<span class="stringliteral">&quot;scaled_linear_beta&quot;</span>,</div>
<div class="line"><span class="lineno">    4</span>        beta_start=0.0015,</div>
<div class="line"><span class="lineno">    5</span>        beta_end=0.0195,</div>
<div class="line"><span class="lineno">    6</span>    )</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac61c15ad0e4f79cc2ebc49667748b0a6" name="ac61c15ad0e4f79cc2ebc49667748b0a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac61c15ad0e4f79cc2ebc49667748b0a6">&#9670;&#160;</a></span>set_to_none</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.set_to_none</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8a53cfb53649304f990778b717ceb1ab" name="a8a53cfb53649304f990778b717ceb1ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a53cfb53649304f990778b717ceb1ab">&#9670;&#160;</a></span>synthetic_images</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.synthetic_images</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  inferer.sample(</div>
<div class="line"><span class="lineno">    2</span>        input_noise=noise,</div>
<div class="line"><span class="lineno">    3</span>        autoencoder_model=autoencoder,</div>
<div class="line"><span class="lineno">    4</span>        diffusion_model=unet,</div>
<div class="line"><span class="lineno">    5</span>        scheduler=scheduler,</div>
<div class="line"><span class="lineno">    6</span>    )</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9f54d343a09f11ab6b7830e33f2b7cc0" name="a9f54d343a09f11ab6b7830e33f2b7cc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f54d343a09f11ab6b7830e33f2b7cc0">&#9670;&#160;</a></span>timesteps</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.timesteps</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  torch.randint(</div>
<div class="line"><span class="lineno">    2</span>                    0,</div>
<div class="line"><span class="lineno">    3</span>                    inferer.scheduler.num_train_timesteps,</div>
<div class="line"><span class="lineno">    4</span>                    (images.shape[0],),</div>
<div class="line"><span class="lineno">    5</span>                    device=images.device,</div>
<div class="line"><span class="lineno">    6</span>                ).long()</div>
</div><!-- fragment -->
</div>
</div>
<a id="afa811e971dc88624429d857151d09301" name="afa811e971dc88624429d857151d09301"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa811e971dc88624429d857151d09301">&#9670;&#160;</a></span>train_ds</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.train_ds</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  CustomDataset(</div>
<div class="line"><span class="lineno">    2</span>        root_dir=root_dir,</div>
<div class="line"><span class="lineno">    3</span>        section=<span class="stringliteral">&quot;training&quot;</span>,  <span class="comment"># validation</span></div>
<div class="line"><span class="lineno">    4</span>        cache_rate=0.0,  <span class="comment"># you may need a few Gb of RAM... Set to 0 otherwise</span></div>
<div class="line"><span class="lineno">    5</span>        num_workers=0,  <span class="comment"># Set download to True  if the dataset hasnt been downloaded yet</span></div>
<div class="line"><span class="lineno">    6</span>        transform=train_transforms,</div>
<div class="line"><span class="lineno">    7</span>        download=<span class="keyword">False</span>,</div>
<div class="line"><span class="lineno">    8</span>        seed=0,</div>
<div class="line"><span class="lineno">    9</span>    )</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1dad551e6b78b06c9b027213609b1f3e" name="a1dad551e6b78b06c9b027213609b1f3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1dad551e6b78b06c9b027213609b1f3e">&#9670;&#160;</a></span>train_loader</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.train_loader</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  DataLoader(</div>
<div class="line"><span class="lineno">    2</span>        train_ds,</div>
<div class="line"><span class="lineno">    3</span>        batch_size=batch_size,</div>
<div class="line"><span class="lineno">    4</span>        shuffle=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">    5</span>        num_workers=0,</div>
<div class="line"><span class="lineno">    6</span>        persistent_workers=<span class="keyword">False</span>,</div>
<div class="line"><span class="lineno">    7</span>    )</div>
</div><!-- fragment -->
</div>
</div>
<a id="afff5309d80cb7064ae68a100d698c702" name="afff5309d80cb7064ae68a100d698c702"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afff5309d80cb7064ae68a100d698c702">&#9670;&#160;</a></span>train_transforms</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.train_transforms</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  transforms.Compose(</div>
<div class="line"><span class="lineno">    2</span>        [</div>
<div class="line"><span class="lineno">    3</span>            transforms.LoadImaged(keys=[<span class="stringliteral">&quot;image&quot;</span>], reader=NibabelReader),</div>
<div class="line"><span class="lineno">    4</span>            transforms.EnsureChannelFirstd(keys=[<span class="stringliteral">&quot;image&quot;</span>]),</div>
<div class="line"><span class="lineno">    5</span>            transforms.Lambdad(keys=<span class="stringliteral">&quot;image&quot;</span>, func=select_channel),</div>
<div class="line"><span class="lineno">    6</span>            transforms.EnsureChannelFirstd(keys=[<span class="stringliteral">&quot;image&quot;</span>], channel_dim=<span class="stringliteral">&quot;no_channel&quot;</span>),</div>
<div class="line"><span class="lineno">    7</span>            transforms.EnsureTyped(keys=[<span class="stringliteral">&quot;image&quot;</span>]),</div>
<div class="line"><span class="lineno">    8</span>            transforms.Orientationd(keys=[<span class="stringliteral">&quot;image&quot;</span>], axcodes=<span class="stringliteral">&quot;RAS&quot;</span>),</div>
<div class="line"><span class="lineno">    9</span>            transforms.Spacingd(keys=[<span class="stringliteral">&quot;image&quot;</span>], pixdim=(2.4, 2.4, 2.2), mode=(<span class="stringliteral">&quot;bilinear&quot;</span>)),</div>
<div class="line"><span class="lineno">   10</span>            SpatialPadd(keys=[<span class="stringliteral">&quot;image&quot;</span>], spatial_size=(32, 32, 32), method=<span class="stringliteral">&#39;symmetric&#39;</span>),</div>
<div class="line"><span class="lineno">   11</span>            transforms.CenterSpatialCropd(keys=[<span class="stringliteral">&quot;image&quot;</span>], roi_size=(32, 32, 32)),</div>
<div class="line"><span class="lineno">   12</span>            transforms.ScaleIntensityRangePercentilesd(</div>
<div class="line"><span class="lineno">   13</span>                keys=<span class="stringliteral">&quot;image&quot;</span>, lower=0, upper=99.5, b_min=0, b_max=1</div>
<div class="line"><span class="lineno">   14</span>            ),</div>
<div class="line"><span class="lineno">   15</span>        ]</div>
<div class="line"><span class="lineno">   16</span>    )</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5a8b9b4825d205a673e21352b91cf716" name="a5a8b9b4825d205a673e21352b91cf716"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a8b9b4825d205a673e21352b91cf716">&#9670;&#160;</a></span>unet</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.unet</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  DiffusionModelUNet(</div>
<div class="line"><span class="lineno">    2</span>        spatial_dims=3,</div>
<div class="line"><span class="lineno">    3</span>        in_channels=2,</div>
<div class="line"><span class="lineno">    4</span>        out_channels=2,</div>
<div class="line"><span class="lineno">    5</span>        num_res_blocks=1,</div>
<div class="line"><span class="lineno">    6</span>        num_channels=(32, 64, 64),</div>
<div class="line"><span class="lineno">    7</span>        attention_levels=(<span class="keyword">False</span>, <span class="keyword">True</span>, <span class="keyword">True</span>),</div>
<div class="line"><span class="lineno">    8</span>        num_head_channels=(0, 64, 64),</div>
<div class="line"><span class="lineno">    9</span>    )</div>
</div><!-- fragment -->
</div>
</div>
<a id="acb77d6c0f1c0bd1f6f57a537e724024d" name="acb77d6c0f1c0bd1f6f57a537e724024d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb77d6c0f1c0bd1f6f57a537e724024d">&#9670;&#160;</a></span>val_interval</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int training.val_interval = 10</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a4caf0bd6482657203cb209cf60cb9703" name="a4caf0bd6482657203cb209cf60cb9703"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4caf0bd6482657203cb209cf60cb9703">&#9670;&#160;</a></span>val_recon_epoch_loss_list</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">list training.val_recon_epoch_loss_list = []</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aa3b20336dd35c41b00e8433dafe88c08" name="aa3b20336dd35c41b00e8433dafe88c08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3b20336dd35c41b00e8433dafe88c08">&#9670;&#160;</a></span>z</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.z = autoencoder.encode_stage_2_inputs(<a class="el" href="#aff151287638b4debf8d1d3ca23e3e151">first_batch</a>[&quot;image&quot;].to(<a class="el" href="#ac2e72ed2e193555d2666612591286b46">device</a>))</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2cd3eab0c728c5d13c4a9ffed35586e4" name="a2cd3eab0c728c5d13c4a9ffed35586e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2cd3eab0c728c5d13c4a9ffed35586e4">&#9670;&#160;</a></span>z_mu</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.z_mu</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad7e870dcaeb35c2e00fd8b3e6e818473" name="ad7e870dcaeb35c2e00fd8b3e6e818473"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7e870dcaeb35c2e00fd8b3e6e818473">&#9670;&#160;</a></span>z_sigma</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">training.z_sigma</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacetraining.html">training</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
